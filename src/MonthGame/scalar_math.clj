(ns MonthGame.scalar-math
  (:use MonthGame.vector))

(defn within [v range]
  (< (Math/abs v) range))

(defn dir-to-rotate [vfrom vto]
  (let [afrom (vang vfrom)
	ato (vang vto)
	delta (- ato afrom)
	pi (Math/PI)]
    (cond
     (> delta 0) (if (< delta pi) 1 -1)
     (< delta 0) (if (< delta (neg pi)) 1 -1)
     true 0)))

(defn add-on-circle [angle incr]
     (let [new-angle (+ angle incr)
	   twopi (* Math/PI 2)]
       (cond (> new-angle twopi) (- new-angle twopi)
	     (< new-angle 0) (+ new-angle twopi)
	     true new-angle)))
	   
(defn incr-cyclic [n max]
  (mod (+ n 1) max))

(defn >>> [v n]
  (MonthGame.BitShift/unsignedShiftRight v n))

(defn low-byte [sh]
  (MonthGame.BitShift/lowByte sh))

(defn high-byte [sh]
  (MonthGame.BitShift/highByte sh))
